<?php

namespace CveBot\Plugin\CvePlugin;

class Cve {
    protected $name;
    protected $timestamp;
    protected $url;
    protected $tags;
    protected $desc;

    public function __construct($name, $timestamp, $url, $tags, $desc) {
        $this->name = $name;
        $this->timestamp = $timestamp;
        $this->url = $url;
        $this->tags = $tags;
        $this->desc = $desc;
    }

    public function getName() {
        return $this->name;
    }

    public function getTimestamp() {
        return $this->timestamp;
    }

    public function getTags() {
        return $this->tags;
    }

    public function getDescription() {
        return $this->desc;
    }

    public function format() {
        $timestamp = date('M j Y H:i:s', $this->timestamp);
        $desc = strlen($this->desc) > 250
            ? substr($this->desc, 0, 250) . ' ...'
            : $this->desc;

        return "[{$this->name}] ($timestamp) {$this->url} -- $desc";
    }
}
